<!-- Desktop Sidebar -->
<div
  *ngIf="!isMobile"
  class="sidebar-container"
  [class.sidebar-collapsed]="isCollapsed"
  [style.width]="isCollapsed ? '70px' : '250px'"
>
  <!-- Profile Section -->
  <div class="border-bottom p-3 d-flex flex-column align-items-center">
    <div class="d-flex flex-column align-items-center w-100 position-relative">
      <div class="mb-2" [class.avatar-collapsed]="isCollapsed">
        <img
          [src]="user.profileImage || './default-avatar.jpg'"
          class="rounded-circle border object-fit-cover"
          [style.width]="isCollapsed ? '36px' : '50px'"
          [style.height]="isCollapsed ? '36px' : '50px'"
        />
      </div>
      <!-- Expanded State - Button on right -->
      <div
        class="w-100 d-flex justify-content-between align-items-center"
        [class.d-none]="isCollapsed"
      >
        <div>
          <h6 class="mb-0">{{ user.name }}</h6>
          <small class="text-muted">{{
            user.email || "guest@example.com"
          }}</small>
        </div>
        <button
          class="btn btn-sm btn-outline-secondary ms-2"
          (click)="toggleCollapse()"
          title="Collapse sidebar"
        >
          <i class="bi bi-chevron-left"></i>
        </button>
      </div>

      <!-- Collapsed State - Button below -->
      <div class="text-center" [class.d-none]="!isCollapsed">
        <button
          class="btn btn-sm btn-outline-secondary rounded-circle p-1 mt-1"
          (click)="toggleCollapse()"
          title="Expand sidebar"
          style="width: 30px; height: 30px"
        >
          <i class="bi bi-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Menu Items - This div will scroll when content overflows -->
  <div class="menuItemsDiv">
    <ul class="nav flex-column p-2">
      <li class="nav-item my-1" *ngFor="let item of menuItems">
        <a
          class="nav-link d-flex align-items-center py-2 px-3 rounded text-dark text-decoration-none"
          [routerLink]="item.menuPath"
          routerLinkActive="active bg-primary text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          [attr.title]="isCollapsed ? item.menuName : null"
        >
          <i
            class="bi bi-{{ item.menuIcon || 'circle' }} fs-5"
            [class.me-3]="!isCollapsed"
          ></i>
          <span class="flex-grow-1" [class.d-none]="isCollapsed">
            {{ item.menuName }}
          </span>
        </a>
      </li>

      <span *ngIf="masterItems.length" class="text-center">
        <hr />
        <span class="fw-bolder" [class.masterFont]="isCollapsed"
          >Master Data</span
        >
        <hr />
      </span>
      <li class="nav-item my-1" *ngFor="let item of masterItems">
        <a
          class="nav-link d-flex align-items-center py-2 px-3 rounded text-dark text-decoration-none"
          [routerLink]="item.menuPath"
          routerLinkActive="active bg-primary text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          [attr.title]="isCollapsed ? item.menuName : null"
        >
          <i
            class="bi bi-{{ item.menuIcon || 'circle' }} fs-5"
            [class.me-3]="!isCollapsed"
          ></i>
          <span class="flex-grow-1" [class.d-none]="isCollapsed">
            {{ item.menuName }}
          </span>
        </a>
      </li>
    </ul>
  </div>
  <!-- Mobile Menu Overlay -->
  <div
    *ngIf="isMobileMenuOpen && isMobile"
    class="position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50"
    style="z-index: 1050"
    (click)="closeMobileMenu()"
  ></div>

  <!-- Mobile Menu Content -->
  <div
    *ngIf="isMobile"
    class="position-fixed top-0 start-0 h-100 bg-light d-flex flex-column border-end shadow"
    style="
      width: 280px;
      z-index: 1060;
      transition: transform 0.3s ease;
      transform: translateX(-100%);
    "
    [style.top]="'60px'"
    [style.bottom]="'50px'"
    [style.transform]="isMobileMenuOpen ? 'translateX(0)' : 'translateX(-100%)'"
  >
    <div
      class="d-flex justify-content-between align-items-center p-3 border-bottom"
    >
      <div class="d-flex align-items-center">
        <img
          [src]="user.profileImage || './default-avatar.jpg'"
          class="rounded-circle border me-3 object-fit-cover"
          style="width: 50px; height: 50px"
        />
        <div>
          <h6 class="mb-0">{{ user.name || "Guest User" }}</h6>
          <small class="text-muted">{{
            user.email || "guest@example.com"
          }}</small>
        </div>
      </div>
      <button class="btn-close" (click)="closeMobileMenu()"></button>
    </div>

    <div class="menuItemsDiv">
      <ul class="nav flex-column p-2">
        <li class="nav-item my-1" *ngFor="let item of menuItems">
          <a
            class="nav-link d-flex align-items-center py-2 px-3 rounded text-dark text-decoration-none"
            [routerLink]="item.menuPath"
            routerLinkActive="active bg-primary text-white"
            [routerLinkActiveOptions]="{ exact: true }"
            (click)="closeMobileMenu()"
          >
            <i class="bi bi-{{ item.menuIcon || 'circle' }} me-3"></i>
            <span>{{ item.menuName }}</span>
          </a>
        </li>

        <span *ngIf="masterItems.length" class="text-center">
          <hr />
          <span class="fw-bolder">Master Data</span>
          <hr />
        </span>

        <li class="nav-item my-1" *ngFor="let item of masterItems">
          <a
            class="nav-link d-flex align-items-center py-2 px-3 rounded text-dark text-decoration-none"
            [routerLink]="item.menuPath"
            routerLinkActive="active bg-primary text-white"
            [routerLinkActiveOptions]="{ exact: true }"
            (click)="closeMobileMenu()"
          >
            <i class="bi bi-{{ item.menuIcon || 'circle' }} me-3"></i>
            <span>{{ item.menuName }}</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>
